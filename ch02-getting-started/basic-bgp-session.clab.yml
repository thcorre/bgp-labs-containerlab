# =============================================================================
# Lab: Basic BGP Session Establishment
# Book: Versatile Routing and Services with BGP - Volume II
# Chapter: 2 - Getting Started
# =============================================================================
# This lab demonstrates:
# - Basic EBGP and IBGP session configuration
# - Session negotiation and capabilities exchange
# - BGP Finite State Machine (FSM) states
# - Multi-Protocol BGP (MP-BGP) for IPv4 unicast
# =============================================================================
#
# Topology:
#
#                    AS 64496
#    +----------------------------------------+
#    |                                        |
#    |   +------+          +------+           |
#    |   |  R1  |----------|  R2  |           |
#    |   +------+          +------+           |
#    |       |                 |              |
#    |       |     IBGP        |              |
#    |       +--------+--------+              |
#    |                |                       |
#    +----------------|------------------------+
#                     |
#               +------+------+
#               |     R3      |  AS 64511 (External Peer)
#               +-------------+
#
# =============================================================================

name: ch02-basic-bgp

topology:
  kinds:
    nokia_srsim:
      image: nokia_srsim:25.10.R2
      type: sr-1
      license: /opt/nokia/sros/license.txt

  nodes:
    # Core router R1 - AS 64496
    R1:
      kind: nokia_srsim
      startup-config: configs/R1.partial.cfg
      
    # Core router R2 - AS 64496  
    R2:
      kind: nokia_srsim
      startup-config: configs/R2.partial.cfg
      
    # External peer R3 - AS 64511
    R3:
      kind: nokia_srsim
      startup-config: configs/R3.partial.cfg

  links:
    # R1 to R2 - Internal link
    - endpoints: ["R1:1/1/c1/1", "R2:1/1/c1/1"]
    # R1 to R3 - EBGP link  
    - endpoints: ["R1:1/1/c2/1", "R3:1/1/c1/1"]
    # R2 to R3 - EBGP link (backup)
    - endpoints: ["R2:1/1/c2/1", "R3:1/1/c2/1"]