# =============================================================================
# Lab: EVPN IP Prefix (Route-Type 5)
# Book: Versatile Routing and Services with BGP - Volume II
# Chapter: 6 - Ethernet VPN (continued)
# =============================================================================
# This lab demonstrates:
# - EVPN Route-Type 5 (IP Prefix Advertisement)
# - Interface-ful with SBD IRB model
# - Interface-less IP-VRF-to-IP-VRF model
# - EVPN-VXLAN overlay
# =============================================================================
#
# Topology:
#
#    Host1 --- Leaf1 ----------- Spine1 ----------- Leaf3 --- Host3
#                \                 |                /
#                 \               |               /
#                  +--- Spine2 --+--- Spine2 ----+
#                 /               |               \
#                /                |                \
#    Host2 --- Leaf2 ----------- Spine1 ----------- Leaf4 --- Host4
#
# Data Center Fabric with EVPN RT-5 for L3 routing
# =============================================================================

name: ch06-evpn-rt5-ipprefix

topology:
  kinds:
    nokia_srsim:
      image: nokia_srsim:25.10.R1
      type: sr-1
      license: /opt/nokia/sros/license.txt
    linux:
      image: ghcr.io/hellt/network-multitool:latest

  nodes:
    # Spine switches
    Spine1:
      kind: nokia_srsim
      startup-config: configs/Spine1.cfg
      
    Spine2:
      kind: nokia_srsim
      startup-config: configs/Spine2.cfg
      
    # Leaf switches (VTEP/PE)
    Leaf1:
      kind: nokia_srsim
      startup-config: configs/Leaf1.cfg
      
    Leaf2:
      kind: nokia_srsim
      startup-config: configs/Leaf2.cfg
      
    Leaf3:
      kind: nokia_srsim
      startup-config: configs/Leaf3.cfg
      
    Leaf4:
      kind: nokia_srsim
      startup-config: configs/Leaf4.cfg
      
    # Hosts (different subnets)
    Host1:
      kind: linux
      
    Host2:
      kind: linux
      
    Host3:
      kind: linux
      
    Host4:
      kind: linux

  links:
    # Spine-Leaf fabric
    - endpoints: ["Spine1:1/1/1", "Leaf1:1/1/1"]
    - endpoints: ["Spine1:1/1/2", "Leaf2:1/1/1"]
    - endpoints: ["Spine1:1/1/3", "Leaf3:1/1/1"]
    - endpoints: ["Spine1:1/1/4", "Leaf4:1/1/1"]
    - endpoints: ["Spine2:1/1/1", "Leaf1:1/1/2"]
    - endpoints: ["Spine2:1/1/2", "Leaf2:1/1/2"]
    - endpoints: ["Spine2:1/1/3", "Leaf3:1/1/2"]
    - endpoints: ["Spine2:1/1/4", "Leaf4:1/1/2"]
    
    # Host connections
    - endpoints: ["Host1:eth1", "Leaf1:1/1/3"]
    - endpoints: ["Host2:eth1", "Leaf2:1/1/3"]
    - endpoints: ["Host3:eth1", "Leaf3:1/1/3"]
    - endpoints: ["Host4:eth1", "Leaf4:1/1/3"]
